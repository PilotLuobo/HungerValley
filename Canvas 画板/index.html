<!doctype html>
<html lang="zh-hans">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="./style.css" class="rel">
    <title>canvas画板</title>
</head>
<body>
<canvas id="canvas" width="300px" height="300px">
</canvas>
<button id="eraser">橡皮擦</button>
<script>
    var yyy = document.getElementById('canvas')
    adjustsize()
    window.onresize = function () {
        adjustsize()
    }
    var context = yyy.getContext('2d')

    var using = false
    var eraserEnabled = false

    /******/
    eraser.onclick = function () {
        eraserEnabled = !eraserEnabled
    }
    /******/

    var lastPoint = {x: undefined, y: undefined}
    yyy.onmousedown = function (aaa) {
        var x = aaa.clientX
        var y = aaa.clientY
        if (eraserEnabled) {
            using = true
            context.clearRect(x, y, 10, 10)
        } else {
            using = true
            lastPoint = {x: x, y: y}
            drawCircle(x, y, 5)
        }
    }

    yyy.onmousemove = function (aaa) {
        var x = aaa.clientX
        var y = aaa.clientY
        if (eraserEnabled) {
            if(using){
                context.clearRect(x-5, y-5, 10, 10)
            }
        }
        else if (using) {
            var newPoint = {x: x, y: y}
            drawCircle(x, y, 5)
            drawLine(lastPoint.x, lastPoint.y, newPoint.x, newPoint.y)
            lastPoint = newPoint
        }
    }

    yyy.onmouseup = function (aaa) {
        using = false
    }

    /***工具函数***/
    function adjustsize() {
        var pageWidth = document.documentElement.clientWidth
        var pageHeight = document.documentElement.clientHeight
        yyy.width = pageWidth
        yyy.height = pageHeight
    }

    function drawCircle(x, y, radius) {
        context.beginPath()
        context.fillStyle = 'black'
        context.arc(x, y, radius, 0, Math.PI * 2)
        context.fill()
    }

    function drawLine(x1, y1, x2, y2) {
        context.beginPath()
        context.moveTo(x1, y1)    //起点
        context.lineWidth = 10
        context.strokeStyle = 'black'
        context.lineTo(x2, y2)    //终点
        context.stroke()
    }

    /***工具函数***/
</script>
</body>
</html>